"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[1248],{8206:(e,r,a)=>{a.d(r,{t:()=>l});var s=a(47262),i=a(95441),t=a(66616),n=a(4637);const l=({project:e,index:r,onClick:a})=>(0,n.jsx)(s.C,{index:r,onClick:()=>a(e.key),headerText:e.title,featureIdentifier:"make_music",uri:e.originalTrackUri,delegateNavigation:!0,renderCardImage:()=>(0,n.jsx)(i.x,{images:[{url:e.imageUri}]}),renderSubHeaderContent:()=>(0,n.jsx)(t.NB,{source:e.templateDescription})})},3752:(e,r,a)=>{a.r(r),a.d(r,{UserSong:()=>M,default:()=>X,parseReleaseDate:()=>J});var s=a(59496),i=a(90641),t=a(92053),n=a(53083),l=a(77250),o=a(6063),c=a(58908),u=a(80326),d=a(17913),m=a(97921),g=a(14571),h=a(86417),p=a(18805),x=a(53965),f=a(99567),j=a(27293),y=a(93824),b=a(47807),k=a(75449),I=a(15607),P=a(92753),v=a(38391),C=a(15310),S=a(55540),U=a(13870),w=a(58964),D=a(68765),R=a(4899),T=a(64384),E=a(64237),N=a(93630),L=a(13034),A=a(16020),_=a(38698),O=a(8206),B=a(17160),H=a(51841),F=a(23351),Q=a(4637);const Y=[H.QD.INDEX,H.QD.TITLE,H.QD.DURATION],z=s.memo((function({ariaLabel:e,tracks:r,creator:a,highlightUri:i,scrollToIndex:t,usePlayContextItem:n,hasHeaderRow:l=!0}){const o=(0,s.useRef)(null),c=(0,s.useRef)(!1),[u]=(0,s.useState)(null);(0,s.useEffect)((()=>{o.current&&(u?o.current.scrollToIndex(u):t&&o.current.scrollToIndex(t))}),[u,t]);const d=(0,s.useCallback)(((e,r)=>{const s=!c.current&&!!i&&i===e.uri;return s&&(c.current=!0),(0,Q.jsx)(H.Ym,{index:r,trackNumber:r+1,contextUri:a.uri,uri:e.uri,duration_ms:e.duration.milliseconds,name:e.name,isPlayable:e.playability.playable,artists:[{uri:a.uri,profile:{name:a.displayName??a.name??""}}],playcount:0,shouldRenderPlayCount:!1,shouldHighLight:s,usePlayContextItem:n},r+e.uri)}),[a,i,n]),m=(0,s.useCallback)((e=>"track"in e?e.track.uri:""),[]);return(0,Q.jsx)(F.ZP,{value:"album-tracklist",children:(0,Q.jsx)(H.Pv,{ariaLabel:e,tracks:r,hasHeaderRow:l,rowPlaceholder:H.uD,columns:Y,renderRow:d,resolveUri:m,nrTracks:r.length,outerRef:o},a.uri)})}));var W=a(76760);const $="a4JGtYPrNWmb5GUgrYMX",q="Y3jBRL4mS97_u1yK6lml",G="uV9hvAknI8LQmO3fPuqx",M=({episode:e,creator:r})=>{const{uri:a,coverArt:o}=e,c=(0,t.TH)(),{spec:j,logger:k}=(0,L.fU)(l.createDesktopEpisodeEventFactory,{data:{uri:a}}),I=(0,w.g)(),U=(0,P.o)(),E=parseInt(new URLSearchParams(c.search).get("index")||"0",10),{usePlayContextItem:N,triggerPlay:A,togglePlay:H,isActive:F}=(0,D.n)({uri:a},{featureIdentifier:"episode"}),{isPlaying:Y,isActive:M}=(0,R.$o)(a),X=o[0].url,K=(0,v.Zj)(X||null),V=(0,T.Y)((e=>e?.isPaused??void 0)),Z=M||F,ee=(0,s.useCallback)(((e,r,s)=>{let i="play";if(!Y||0!==e&&r||(i="pause"),U({intent:i,targetUri:a,type:"click",itemIdSuffix:e>0?"podcast-description-timestamp":"button"}),F&&!r)H({loggingParams:s?.()});else if(M&&!r)V?(s?.("resume"),I.resume()):(s?.("pause"),I.pause());else{const r=s?.("play");A({seekTo:e,loggingParams:r})}}),[Y,U,a,M,F,V,I,H,A]),re=(0,s.useCallback)((()=>{ee(0,!1,(e=>{const r=j.actionBarFactory().playButtonFactory();let s;return s="pause"===e||Y?r.hitPause({itemToBePaused:a}):"resume"===e||Z?r.hitResume({itemToBeResumed:a}):r.hitPlay({itemToBePlayed:a}),k.logInteraction(s)}))}),[ee,Z,Y,k,j,a]);(0,s.useEffect)((()=>{if(e){const r=new URLSearchParams(c.search);if(r.has("t")){const a=r.get("t")||"0",s=1e3*parseInt(a,10);s<=e.duration.milliseconds&&ee(s,!0)}}}),[e]);const ae=e.playability.playable,se=(e.coverArt||[]).map((e=>({url:e.url,width:e.width||void 0,height:e.height||void 0}))),ie=(0,s.useCallback)((()=>new URLSearchParams(c.search.slice(1)).get("highlight")||""),[c.search])(),te=(0,i.v9)(C.Gg),ne=te.overrides?.locale??te.locale,{projects:le}=(0,W.w)(!1,r.id),[oe,ce]=(0,s.useState)([]);return(0,s.useEffect)((()=>{const r=le.filter((r=>r.publishedTrackUri!==e.uri));ce(r)}),[le,e.uri]),(0,Q.jsxs)("section",{"data-testid":"user-song",className:$,children:[(0,Q.jsx)(h.$,{children:u.ag.get("podcasts.episode.seo.title",{name:e.name,show:e.podcast?.name??""})}),(0,Q.jsxs)(p.gF,{backgroundColor:K,children:[(0,Q.jsxs)(x.W,{children:[(0,Q.jsx)(y.$,{size:"md",onClick:()=>H(),disabled:!ae,isPlaying:Y,uri:a}),(0,Q.jsx)(f.i,{text:e.name})]}),(0,Q.jsx)(S._P,{menu:(0,Q.jsx)(B.kn,{uri:a,sharingInfo:e.sharingInfo}),children:(0,Q.jsx)(p.Oz,{dragUri:a,images:se,name:e.name,placeholderType:"album"})}),(0,Q.jsxs)(p.sP,{children:[(0,Q.jsx)(p.dy,{small:!0,uppercase:!0,children:"Song"}),(0,Q.jsx)(S._P,{menu:(0,Q.jsx)(B.kn,{uri:a,sharingInfo:e.sharingInfo}),children:(0,Q.jsx)(p.xd,{dragUri:e.uri,dragLabel:e.name,children:e.name})}),(0,Q.jsx)(p.QS,{creators:[r],releaseDate:J(e.releaseDate?.isoString),durationMilliseconds:e.duration.milliseconds})]})]}),(0,Q.jsx)(d.o,{backgroundColor:K,children:(0,Q.jsxs)(d.F,{children:[(0,Q.jsx)(y.$,{onClick:re,disabled:!ae,isPlaying:Y,size:"lg",uri:a}),(0,Q.jsx)(g.w,{uri:e.uri,size:m.q.md}),(0,Q.jsx)(S.yj,{menu:(0,Q.jsx)(B.kn,{uri:e.uri,sharingInfo:e.sharingInfo}),children:(0,Q.jsx)(m.z,{label:u.ag.get("more.label.context",e.name)})})]})}),(0,Q.jsxs)("div",{className:"contentSpacing",children:[(0,Q.jsx)(z,{ariaLabel:e.name,tracks:[e],creator:r,highlightUri:ie,scrollToIndex:E,usePlayContextItem:N}),(0,Q.jsx)("div",{className:G,children:(0,Q.jsx)("div",{children:e.releaseDate?.isoString&&(0,Q.jsx)(n.D,{as:"p",variant:"mesto",children:(0,_.BI)((0,_.RX)(e.releaseDate.isoString),ne,{year:"numeric",month:"long",day:"numeric"})})})})]}),oe.length>0&&(0,Q.jsx)("div",{className:"contentSpacing",children:(0,Q.jsx)(b.q,{index:0,id:"more-user-songs",className:q,title:u.ag.get("album-page.more-by-artist",r.displayName??r.name??"User"),total:oe.length,seeAllUri:r.uri,seeAllLabel:"Show profile",alwaysShowSeeAll:!0,children:oe.map(((e,r)=>(0,Q.jsx)(O.t,{index:r,project:e,onClick:()=>{}},e.key)))})})]})},X=s.memo((function(){const{episodeId:e=""}=(0,t.UO)(),r=(0,c.YD)(e).toURI(),a=(0,E.I)(r);let i="";a?.type===A.p.EPISODE&&(i=a.podcast?.uri||"");const{data:n,error:l}=(0,N.l)(i||"");let d="",m="",g="";n?.type===A.p.SHOW&&(d=n.publisherName,m=(0,c.QK)(d).toURI(),g=n.name);const{data:h}=(0,I.J)(U.n5.getProfile,[{uri:m,playlists:10,artists:10,episodes:10}]),p={uri:m,name:g,displayName:g,id:d,images:h?[{url:h.image_url}]:[]};return!a||a.type!==A.p.EPISODE||l?(0,Q.jsx)(j.h,{hasError:!1,errorMessage:u.ag.get("error.not_found.title.podcast")}):(0,Q.jsx)(s.Suspense,{fallback:null,children:(0,Q.jsx)(k.C,{pageId:o.Wg.PODCAST_EPISODE,uri:r,children:(0,Q.jsx)(M,{episode:a,creator:p})})})}));function J(e){return e?.replace(/T.*/,"")||""}},75449:(e,r,a)=>{a.d(r,{C:()=>n});var s=a(59496),i=a(38001),t=a(4637);const n=({pageId:e,uri:r,children:a})=>{const n=(0,i.b)(),l=(0,i.H)();return(0,s.useEffect)((()=>{n?.reportPageView({pageId:e,navigationalRoot:l??void 0,entityUri:r})}),[e,l,n,r]),(0,t.jsx)(t.Fragment,{children:a})}}}]);
//# sourceMappingURL=xpui-routes-soundtrap-user-song.js.map