"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[1248],{8206:(e,r,i)=>{i.d(r,{t:()=>s});var a=i(47262),n=i(95441),l=i(66616),t=i(4637),s=function(e){var r=e.project,i=e.index,s=e.onClick;return(0,t.jsx)(a.C,{index:i,onClick:function(){return s(r.key)},headerText:r.title,featureIdentifier:"make_music",uri:r.originalTrackUri,delegateNavigation:!0,renderCardImage:function(){return(0,t.jsx)(n.x,{images:[{url:r.imageUri}]})},renderSubHeaderContent:function(){return(0,t.jsx)(l.NB,{source:r.templateDescription})}})}},3752:(e,r,i)=>{i.r(r),i.d(r,{UserSong:()=>M,default:()=>X,parseReleaseDate:()=>J});var a=i(14942),n=(i(47785),i(15970),i(93019),i(27586),i(56110),i(4391),i(3761),i(30169),i(47408),i(2840),i(33208),i(25750),i(68063),i(59496)),l=i(77646),t=i(92053),s=i(33892),o=i(77250),u=i(6063),c=i(47018),d=i(22056),m=i(17913),g=i(97921),h=i(14571),p=i(86417),f=i(18805),v=i(53965),x=i(99567),j=i(27293),y=i(93824),b=i(47807),k=i(75449),I=i(15607),P=i(46596),C=i(38391),S=i(15310),U=i(55540),w=i(13870),D=i(58964),R=i(68765),T=i(4899),E=i(64384),N=i(64237),L=i(93630),A=i(13034),_=i(16020),O=i(38698),B=i(8206),H=i(17160),F=i(51841),Q=i(23351),Y=i(4637),z=[F.QD.INDEX,F.QD.TITLE,F.QD.DURATION],W=n.memo((function(e){var r=e.ariaLabel,i=e.tracks,l=e.creator,t=e.highlightUri,s=e.scrollToIndex,o=e.usePlayContextItem,u=e.hasHeaderRow,c=void 0===u||u,d=(0,n.useRef)(null),m=(0,n.useRef)(!1),g=(0,n.useState)(null),h=(0,a.Z)(g,1)[0];(0,n.useEffect)((function(){d.current&&(h?d.current.scrollToIndex(h):s&&d.current.scrollToIndex(s))}),[h,s]);var p=(0,n.useCallback)((function(e,r){var i,a,n=!m.current&&!!t&&t===e.uri;return n&&(m.current=!0),(0,Y.jsx)(F.Ym,{index:r,trackNumber:r+1,contextUri:l.uri,uri:e.uri,duration_ms:e.duration.milliseconds,name:e.name,isPlayable:e.playability.playable,artists:[{uri:l.uri,profile:{name:null!==(i=null!==(a=l.displayName)&&void 0!==a?a:l.name)&&void 0!==i?i:""}}],playcount:0,shouldRenderPlayCount:!1,shouldHighLight:n,usePlayContextItem:o},r+e.uri)}),[l,t,o]),f=(0,n.useCallback)((function(e){return"track"in e?e.track.uri:""}),[]);return(0,Y.jsx)(Q.ZP,{value:"album-tracklist",children:(0,Y.jsx)(F.Pv,{ariaLabel:r,tracks:i,hasHeaderRow:c,rowPlaceholder:F.uD,columns:z,renderRow:p,resolveUri:f,nrTracks:i.length,outerRef:d},l.uri)})})),Z=i(76760);const $="a4JGtYPrNWmb5GUgrYMX",q="Y3jBRL4mS97_u1yK6lml",G="uV9hvAknI8LQmO3fPuqx";var M=function(e){var r,i,u,c,j,k,I,w,N=e.episode,L=e.creator,_=N.uri,F=N.coverArt,Q=(0,t.TH)(),z=(0,A.fU)(o.createDesktopEpisodeEventFactory,{data:{uri:_}}),M=z.spec,X=z.logger,K=(0,D.g)(),V=(0,P.o)(),ee=parseInt(new URLSearchParams(Q.search).get("index")||"0",10),re=(0,R.n)({uri:_},{featureIdentifier:"episode"}),ie=re.usePlayContextItem,ae=re.triggerPlay,ne=re.togglePlay,le=re.isActive,te=(0,T.$o)(_),se=te.isPlaying,oe=te.isActive,ue=F[0].url,ce=(0,C.Zj)(ue||null),de=(0,E.Y)((function(e){var r;return null!==(r=null==e?void 0:e.isPaused)&&void 0!==r?r:void 0})),me=oe||le,ge=(0,n.useCallback)((function(e,r,i){var a="play";if(!se||0!==e&&r||(a="pause"),V({intent:a,targetUri:_,type:"click",itemIdSuffix:e>0?"podcast-description-timestamp":"button"}),le&&!r)ne({loggingParams:null==i?void 0:i()});else if(oe&&!r)de?(null==i||i("resume"),K.resume()):(null==i||i("pause"),K.pause());else{var n=null==i?void 0:i("play");ae({seekTo:e,loggingParams:n})}}),[se,V,_,oe,le,de,K,ne,ae]),he=(0,n.useCallback)((function(){ge(0,!1,(function(e){var r,i=M.actionBarFactory().playButtonFactory();return r="pause"===e||se?i.hitPause({itemToBePaused:_}):"resume"===e||me?i.hitResume({itemToBeResumed:_}):i.hitPlay({itemToBePlayed:_}),X.logInteraction(r)}))}),[ge,me,se,X,M,_]);(0,n.useEffect)((function(){if(N){var e=new URLSearchParams(Q.search);if(e.has("t")){var r=e.get("t")||"0",i=1e3*parseInt(r,10);i<=N.duration.milliseconds&&ge(i,!0)}}}),[N]);var pe=N.playability.playable,fe=(N.coverArt||[]).map((function(e){return{url:e.url,width:e.width||void 0,height:e.height||void 0}})),ve=(0,n.useCallback)((function(){return new URLSearchParams(Q.search.slice(1)).get("highlight")||""}),[Q.search])(),xe=(0,l.v9)(S.Gg),je=null!==(r=null===(i=xe.overrides)||void 0===i?void 0:i.locale)&&void 0!==r?r:xe.locale,ye=(0,Z.w)(!1,L.id).projects,be=(0,n.useState)([]),ke=(0,a.Z)(be,2),Ie=ke[0],Pe=ke[1];return(0,n.useEffect)((function(){var e=ye.filter((function(e){return e.publishedTrackUri!==N.uri}));Pe(e)}),[ye,N.uri]),(0,Y.jsxs)("section",{"data-testid":"user-song",className:$,children:[(0,Y.jsx)(p.$,{children:d.ag.get("podcasts.episode.seo.title",{name:N.name,show:null!==(u=null===(c=N.podcast)||void 0===c?void 0:c.name)&&void 0!==u?u:""})}),(0,Y.jsxs)(f.gF,{backgroundColor:ce,children:[(0,Y.jsxs)(v.W,{children:[(0,Y.jsx)(y.$,{size:"md",onClick:function(){return ne()},disabled:!pe,isPlaying:se,uri:_}),(0,Y.jsx)(x.i,{text:N.name})]}),(0,Y.jsx)(U._P,{menu:(0,Y.jsx)(H.kn,{uri:_,sharingInfo:N.sharingInfo}),children:(0,Y.jsx)(f.Oz,{dragUri:_,images:fe,name:N.name,placeholderType:"album"})}),(0,Y.jsxs)(f.sP,{children:[(0,Y.jsx)(f.dy,{small:!0,uppercase:!0,children:"Song"}),(0,Y.jsx)(U._P,{menu:(0,Y.jsx)(H.kn,{uri:_,sharingInfo:N.sharingInfo}),children:(0,Y.jsx)(f.xd,{dragUri:N.uri,dragLabel:N.name,children:N.name})}),(0,Y.jsx)(f.QS,{creators:[L],releaseDate:J(null===(j=N.releaseDate)||void 0===j?void 0:j.isoString),durationMilliseconds:N.duration.milliseconds})]})]}),(0,Y.jsx)(m.o,{backgroundColor:ce,children:(0,Y.jsxs)(m.F,{children:[(0,Y.jsx)(y.$,{onClick:he,disabled:!pe,isPlaying:se,size:"lg",uri:_}),(0,Y.jsx)(h.w,{uri:N.uri,size:g.q.md}),(0,Y.jsx)(U.yj,{menu:(0,Y.jsx)(H.kn,{uri:N.uri,sharingInfo:N.sharingInfo}),children:(0,Y.jsx)(g.z,{label:d.ag.get("more.label.context",N.name)})})]})}),(0,Y.jsxs)("div",{className:"contentSpacing",children:[(0,Y.jsx)(W,{ariaLabel:N.name,tracks:[N],creator:L,highlightUri:ve,scrollToIndex:ee,usePlayContextItem:ie}),(0,Y.jsx)("div",{className:G,children:(0,Y.jsx)("div",{children:(null===(k=N.releaseDate)||void 0===k?void 0:k.isoString)&&(0,Y.jsx)(s.D,{as:"p",variant:"mesto",children:(0,O.BI)((0,O.RX)(N.releaseDate.isoString),je,{year:"numeric",month:"long",day:"numeric"})})})})]}),Ie.length>0&&(0,Y.jsx)("div",{className:"contentSpacing",children:(0,Y.jsx)(b.q,{index:0,id:"more-user-songs",className:q,title:d.ag.get("album-page.more-by-artist",null!==(I=null!==(w=L.displayName)&&void 0!==w?w:L.name)&&void 0!==I?I:"User"),total:Ie.length,seeAllUri:L.uri,seeAllLabel:"Show profile",alwaysShowSeeAll:!0,children:Ie.map((function(e,r){return(0,Y.jsx)(B.t,{index:r,project:e,onClick:function(){}},e.key)}))})})]})};const X=n.memo((function(){var e,r=(0,t.UO)().episodeId,i=void 0===r?"":r,a=(0,c.YD)(i).toURI(),l=(0,N.I)(a),s="";(null==l?void 0:l.type)===_.p.EPISODE&&(s=(null===(e=l.podcast)||void 0===e?void 0:e.uri)||"");var o=(0,L.l)(s||""),m=o.data,g=o.error,h="",p="",f="";(null==m?void 0:m.type)===_.p.SHOW&&(h=m.publisherName,p=(0,c.QK)(h).toURI(),f=m.name);var v=(0,I.J)(w.n5.getProfile,[{uri:p,playlists:10,artists:10,episodes:10}]).data,x={uri:p,name:f,displayName:f,id:h,images:v?[{url:v.image_url}]:[]};return!l||l.type!==_.p.EPISODE||g?(0,Y.jsx)(j.h,{hasError:!1,errorMessage:d.ag.get("error.not_found.title.podcast")}):(0,Y.jsx)(n.Suspense,{fallback:null,children:(0,Y.jsx)(k.C,{pageId:u.Wg.PODCAST_EPISODE,uri:a,children:(0,Y.jsx)(M,{episode:l,creator:x})})})}));function J(e){return(null==e?void 0:e.replace(/T.*/,""))||""}},75449:(e,r,i)=>{i.d(r,{C:()=>t});var a=i(59496),n=i(38001),l=i(4637),t=function(e){var r=e.pageId,i=e.uri,t=e.children,s=(0,n.b)(),o=(0,n.H)();return(0,a.useEffect)((function(){null==s||s.reportPageView({pageId:r,navigationalRoot:null!=o?o:void 0,entityUri:i})}),[r,o,s,i]),(0,l.jsx)(l.Fragment,{children:t})}}}]);
//# sourceMappingURL=xpui-routes-soundtrap-user-song.js.map