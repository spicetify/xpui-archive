"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2342],{54985:(e,a,i)=>{i.d(a,{g:()=>s});var n=i(51697),t=i(26790),l=i(4637);const s=({children:e})=>{const a=(0,t.jh)()===t.Uo.SMALL?"mesto":"mestoBold";return(0,l.jsx)(n.D,{variant:a,children:e})}},22456:(e,a,i)=>{i.d(a,{x:()=>u});var n=i(59496),t=i(33960),l=i(35960),s=i(7991),r=i(57678),o=i(39667),c=i(8591),d=i(4637);const u=({children:e,action:a,uri:i})=>{const u=(0,l.g)(),m=(0,r.j)();let g;const h=()=>{const e={triggerId:c.K,triggerAction:{type:a}};o.y.set((a=>({...a,...e}))),m.storeAction(s.wH,{operation:t.pT.ADD,uris:[i]})};try{g=n.Children.only(e)}catch(a){return(0,d.jsx)(d.Fragment,{children:e})}return u?n.cloneElement(g,{onClick:h}):(0,d.jsx)(d.Fragment,{children:e})}},31885:(e,a,i)=>{i.r(a),i.d(a,{default:()=>Me});var n=i(59496),t=i(83792),l=i(97601),s=i(51697),r=i(88559),o=i(21054),c=i(9990),d=i(87508),u=i(94633),m=i(28489),g=i(26156),h=i(70304),k=i(7018),x=i(20456),p=i(29915),b=i(75132),j=i(68224),y=i(89723);const v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"queryAlbumMerch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"albumUnion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"merch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumMerchItem"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumMerchItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Merch"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]};var f=i(72009);const N="iEG0moJ3mt1_j9Lho7MA";var C=i(4637);const S=({albumName:e,albumURI:a})=>{const{data:i}=(n={uri:a},t={cacheTime:5*y.y},(0,y.a)(v,n,t));var n,t;const l=i?.albumUnion&&"merch"in i.albumUnion?i?.albumUnion?.merch?.items:[];return l&&l?.length>0?(0,C.jsx)("div",{className:"contentSpacing",children:(0,C.jsx)("div",{className:N,children:(0,C.jsx)(f.s,{id:e,uri:a,merchItems:l,merchVariant:"Album page merch items"})})}):null};var U=i(23419),F=i(53851),I=i(40981),w=i(62768),M=i(4635),A=i(13138),P=i(24966),T=i(34046),D=i(62510),L=i(64689),B=i(46927),V=i(98440),O=i(99750),z=i(40006),E=i(22456),R=i(26473),q=i(18112),_=i(7442),Q=i(34198),$=i(93019),Z=i(47948),H=i(99550);const K=n.memo((function({uri:e,togglePlay:a,isPlaying:i,isActive:t,spec:l,logger:s,backgroundColor:r,name:o,artists:d,isPlayable:m,sharingInfo:h}){const k=(0,q.o)(),x=(0,_.k)(),p=(0,L.y)(),b=(0,n.useMemo)((()=>l.actionBarFactory()),[l]),[y,v]=(0,L.Z)(e),f=(0,n.useCallback)((()=>{const n=(0,Q.aK)({isPlaying:i,isActive:t,spec:b.playButtonFactory(),logger:s,uri:e});a({loggingParams:n})}),[i,t,a,b,s,e]),N=(0,n.useCallback)((async()=>{let a;const i=b.saveButtonFactory();a=y?i.hitDislike({itemToBeDisliked:e}):i.hitLike({itemToBeLiked:e}),s.logInteraction(a),k({targetUri:e,intent:y?"unsave":"save",type:"click"});try{await v(!y)}catch{}}),[k,e,y,v,b,s]),S=(0,c.W6)(Z.eKc,{loadingValue:!1}),U=(0,R.j)();return(0,C.jsx)(B.o,{backgroundColor:r,children:(0,C.jsxs)(B.F,{children:[(0,C.jsx)(j.$,{onClick:f,disabled:!m,isPlaying:i,size:U,uri:e}),S&&(0,C.jsx)(T.Nh,{spec:b,children:(0,C.jsx)(H.K,{entityName:o,contextUri:e,activationPlacement:"bottomEnd",size:U})}),(0,C.jsx)(E.x,{uri:e,action:$.sr.SAVE_ALBUM,children:(0,C.jsx)(V.H,{isAdded:!!y,onClick:N,disabled:!x&&!p?.getCapabilities().canModifyOffline,size:U})}),(0,C.jsx)(O.o,{uri:e,isFollowing:!!y,onClick:(a,i)=>(0,Q.l7)(i,b.downloadButtonFactory(),s,e),onFollow:N,size:U}),(0,C.jsx)(I.ClickToggleContextMenu,{onShow:()=>(0,Q.qq)(b,s),menu:(0,C.jsx)(g.Y,{uri:e,artistUri:d?.[0]?.uri,sharingInfo:h}),children:(0,C.jsx)(z.MoreButton,{label:u.ag.get("more.label.context",o),size:U})})]})})}));var Y=i(56946);const W=864e5,X=365.25*W;var G=i(54985),J=i(12463),ee=i(72951),ae=i(7554),ie=i(6285),ne=i(1541),te=i(20549),le=i(34997);const se="TCmZzqInstJMZjkHgnw3",re="PeNI572tTpqsN23o3QhJ",oe="oUsSfFiifMPXqW0kHjR6",ce="XKvEMQZlPfPncTqiitM5",de="GdbPVlmUCW0Q6ZZ0z0wh",ue="Hu7O5y7x5c7wUYFbnIoS",me=n.memo((function(e){const{images:a,title:i,isOpen:t,onClose:l}=e,s=(0,n.useMemo)((()=>(0,le.X)(a,{desiredSize:1e4})),[a]);return s?(0,C.jsx)(ne.Z,{className:se,isOpen:t,onRequestClose:l,animation:{modal:{base:ce,afterOpen:de,beforeClose:ue}},animated:!0,children:(0,C.jsxs)("div",{style:{"--image-width":`${s.width}px`,"--image-height":`${s.height}px`},className:re,children:[(0,C.jsx)(te.E,{loading:"eager",alt:i,src:s.url,className:oe}),(0,C.jsx)(ie.o,{onClick:l,semanticColor:"textBase",children:u.ag.get("web-player.cover-art-modal.close")})]})}):null}));var ge=i(14887),he=i(74433),ke=i(30477);const xe=({releases:e})=>(0,C.jsx)(he.v,{children:e.map((e=>(0,C.jsx)(ke.s,{role:"menuitem",to:(0,ge.EC)(e.uri).toURLPath(!0),children:e.name},e.uri)))});var pe=i(47419),be=i(11879),je=i(915);const ye="n8Bz0c0v17whD3KfMdOk",ve="zddjxV2lX9ukNM5QXloA",fe="lVqlPjQLuQhK2flsxB78",Ne="O_EguRjsZ4uI1hHamkOA",Ce="jcaQQxoVnuuhtVwDJU1R",Se="fLS8v3_EfBadEerbGVoR",Ue="in4OjUTflcsoj9RUpf05",Fe=n.lazy((()=>i.e(4316).then(i.bind(i,54316))));function Ie(e){switch(e){case be.V.Single:return u.ag.get("single");case be.V.Ep:return u.ag.get("ep");case be.V.Compilation:return u.ag.get("compilation");case be.V.Album:default:return u.ag.get("album")}}const we=({uri:e,album:a})=>{const i=(0,l.TH)(),{spec:b,logger:y,UBIFragment:v}=(0,T.fU)(d.w,{data:{uri:e}}),f=(0,n.useMemo)((()=>b.trackListFactory()),[b]),N=(0,n.useMemo)((()=>b.moreByArtistShelfFactory()),[b]),M=a.moreAlbumsByArtist,L=parseInt(new URLSearchParams((0,l.TH)().search).get("index")||"0",10),B=(0,U.Y)(e),{usePlayContextItem:V,togglePlay:O,isPlaying:z,isActive:E}=(0,A.n)({uri:B},{featureIdentifier:"album"}),R=(0,n.useCallback)(((e,a)=>{if(b){const e=b.headerFactory().artistNameFactory().hitUiNavigate({destination:a.creator.uri});y.logInteraction(e)}}),[y,b]),{isOpen:q,openModal:_,closeModal:Q}=(()=>{const[e,a]=(0,n.useState)(!1);return{isOpen:e,openModal:(0,n.useCallback)((()=>a(!0)),[]),closeModal:(0,n.useCallback)((()=>a(!1)),[])}})(),$=(0,c.W6)(Z.DUY,{loadingValue:!1})?{onClick:_,ariaLabel:u.ag.get("web-player.album.open_coverart_modal")}:{},H=(0,n.useCallback)((()=>new URLSearchParams(i.search.slice(1)).get("highlight")||""),[i.search]),ie=a.uri,ne=a.name,te=a.albumType,le=a.release?.date,se=a.nrTracks,re=a.images,oe=a.extractedColors?.colorRaw.hex,ce=a.artists,de=a.isPlayable,ue=a.isCatalogueRestricted,ge=a.copyright.items,he=a.courtesyLine,ke=a.duration.durationMs,pe=a.duration.isEstimate,be=H(),we=(0,t.v9)(ae.Gg),Me=we.overrides?.locale??u.ag.getLocale(),Ae=(0,ee.k)({uri:e,type:"locale"}),Pe=(0,P.OT)({albumName:ne,albumType:te,albumArtists:ce.map((e=>e.name)).join(u.ag.getSeparator()),shouldLocalize:Ae,i18n:u.ag});(0,F.Y5)(oe||null);const Te=function(e){return(0,n.useMemo)((()=>{if(!e?.date)return null;if("day"===e.precision){const a=new Date(e.date),i=(new Date).getTime()-a.getTime(),n=i%X;return n<3.5*W||n>312552e5?Math.round(i/X):null}return null}),[e])}(a.release);return(0,C.jsxs)("section",{className:ye,"data-testid":"album-page",children:[(0,C.jsx)(h.$,{children:Pe}),null!==Te?(0,C.jsx)(n.Suspense,{fallback:null,children:(0,C.jsx)(Fe,{colorLight:a?.extractedColors?.colorLight.hex,colorDark:a?.extractedColors?.colorDark.hex,name:ne,years:Te})}):null,(0,C.jsxs)(k.gF,{backgroundColor:oe,children:[(0,C.jsxs)(x.W,{children:[(0,C.jsx)(j.$,{size:"medium",onClick:()=>O(),disabled:!de,isPlaying:z,uri:e}),(0,C.jsx)(p.i,{text:ne,dragUri:e,dragLabel:ne})]}),(0,C.jsx)(I._,{menu:(0,C.jsx)(g.Y,{uri:a.uri,artistUri:ce?.[0]?.uri,sharingInfo:a.sharingInfo}),children:(0,C.jsx)(k.Oz,{dragUri:ie,images:re,name:ne,placeholderType:"album",...$})}),(0,C.jsxs)(k.sP,{children:[(0,C.jsx)(G.g,{children:Ie(te)}),(0,C.jsx)(I._,{menu:(0,C.jsx)(g.Y,{uri:a.uri,artistUri:ce?.[0]?.uri,sharingInfo:a.sharingInfo}),children:(0,C.jsx)(k.xd,{dragUri:a.uri,dragLabel:a.name,scaleAtMinWidth:k.vz,children:ne})}),(0,C.jsx)(k.QS,{creators:ce,onCreatorClick:R,releaseDate:le,totalTracks:se,durationMilliseconds:ke,isEstimatedDuration:pe})]})]}),(0,C.jsx)(K,{backgroundColor:oe,uri:e,togglePlay:O,isPlaying:z,isActive:E,spec:b,logger:y,sharingInfo:a.sharingInfo,name:a.name,artists:a.artists,isPlayable:a.isPlayable}),ue?(0,C.jsxs)("div",{className:ve,children:[(0,C.jsx)(s.D,{as:"h2",variant:"cello",className:fe,children:u.ag.get("windowed.product-album-header")}),(0,C.jsx)("div",{className:Ne,children:u.ag.get("windowed.product-album-description")})]}):null,(0,C.jsxs)("div",{className:"contentSpacing",children:[(0,C.jsx)(v,{spec:f,children:(0,C.jsx)(Y.L,{ariaLabel:ne,nrTracks:(0,je.y)(a.discs)?a.discs.totalCount+se:se,discs:a.discs,albumUri:ie,highlightUri:be,scrollToIndex:L,usePlayContextItem:V,initalTracks:a.items})}),(0,C.jsxs)("div",{className:Ue,children:[(0,C.jsxs)("div",{children:[le&&(0,C.jsx)(s.D,{as:"p",variant:"mesto",children:(0,D.BI)((0,D.RX)(le),Me,{year:"numeric",month:"long",day:"numeric"})}),(0,C.jsx)(w.k,{copyrights:ge,courtesyLine:he})]}),a.releases.items.length>0&&(0,C.jsx)(I.x,{menu:(0,C.jsx)(xe,{releases:a.releases.items}),children:(e,i,n)=>(0,C.jsxs)("button",{ref:n,className:Se,type:"button",onClick:i,children:[(0,C.jsx)(s.D,{variant:"mesto",children:u.ag.get("album-page.more-releases",a.releases.items.length)}),e?(0,C.jsx)(r.U,{iconSize:16}):(0,C.jsx)(o.i,{iconSize:16})]})})]})]}),(0,C.jsx)(S,{albumName:ne,albumURI:ie}),(0,C.jsx)(C.Fragment,{children:M?.length>0&&(0,C.jsx)("div",{className:"contentSpacing",children:(0,C.jsx)(v,{spec:N,children:(0,C.jsx)(J.q,{index:0,id:"more-albums",className:Ce,title:u.ag.get("album-page.more-by-artist",ce?.[0]?.name),total:M.length,seeAllUri:`${ce?.[0]?.uri.replace("artist","app:artist")}:discography`,seeAllLabel:u.ag.get("artist-page.show-discography"),alwaysShowSeeAll:!0,children:M.map(((e,a)=>(0,C.jsx)(m.i,{index:a,artists:ce,images:e.images||[],name:e.name,uri:e.uri,year:e.year,type:e.albumType,sharingInfo:e.sharingInfo},e.uri)))})})})}),(0,C.jsx)(me,{title:Pe,isOpen:q,onClose:Q,images:re})]})},Me=n.memo((function(){const{albumId:e}=(0,l.UO)(),a=`spotify:album:${e}`,{loading:i,error:n,data:t,canLoadOffline:s}=(0,pe.j)(a);return i||!t?(0,C.jsx)(b.h,{hasError:null!==n,loadOffline:s,errorMessage:u.ag.get("error.not_found.title.album")}):(0,C.jsx)(M.fd,{surface:M.Tg.ALBUM,uris:[a],children:(0,C.jsx)(we,{uri:a,album:t})})}))},62768:(e,a,i)=>{i.d(a,{k:()=>s});var n=i(51697);const t="rTMkDBDp47Eo12ZEQv4U";var l=i(4637);const s=({copyrights:e,courtesyLine:a})=>{const i=(e||[]).map(((e,a)=>{const i=e.text.replace(/^(\(C\)\s+)/,"").replace(/^(\(P\)\s+)/,"").replace(/^(©\s+)/,"").replace(/^(℗\s+)/,"");let t;return t="C"===e.type?"©":"P"===e.type?"℗":`(${e.type})`,(0,l.jsx)(n.D,{as:"p",variant:"finale",dir:"auto",children:`${t} ${i}`},a)}));return a&&i.unshift((0,l.jsx)(n.D,{as:"p",variant:"finale",dir:"auto",children:a},i.length)),(0,l.jsx)("div",{className:t,children:i})}}}]);
//# sourceMappingURL=xpui-routes-album.js.map