"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[3417],{16481:(e,t,i)=>{i.r(t),i.d(t,{FeatureActivationSection:()=>He});var a=i(93209),n=i(44073),r=(i(60905),i(51725),i(78381),i(38858),i(98168),i(94238),i(62172),i(9332),i(21932),i(60850),i(21256),i(66874),i(83892),i(45991),i(4207),i(69645),i(9981),i(31840),i(36490),i(93902),i(7410),i(99709));function o(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw r}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}var s={collaborativePlaylists:r.X.CollaborativePlaylists,liveEvents:r.X.LiveEvents,groupSessions:r.X.GroupSessions,veryHighQualityAudio:r.X.VeryHighQualityAudio,blend:r.X.Blend,smartShuffle:r.X.SmartShuffle,dj:r.X.Dj};function c(e){var t,i,a,r,l=[],c=o(e);try{for(c.s();!(t=c.n()).done;){var u=t.value;if(r=u,"object"===(0,n.A)(r)&&null!==r&&"data"in r&&"object"===(0,n.A)(r.data)&&null!==r.data&&"name"in r.data){var f=(i=u.data.name,a=void 0,null===i?null:null!==(a=s[i])&&void 0!==a?a:null);if(null===f)continue;l.push({feature:f,activated:u.data.activated,image:u.data.image,title:u.data.title,uri:u.data.uri,name:u.data.name,destination:u.data.destination})}}}catch(e){c.e(e)}finally{c.f()}return l}i(84008),i(50252);var u=i(30758),f=i(33990),d=i(59081),v=i(81226),p=i(97500),y=i.n(p),g=i(21560),h=i(76470),m=i(14216);const b="NTywvDEuW1PlcoR__9XV",j="BkQ1MPUWBY0WvjENXmC7",A="hwhquP1FOxRcCnf84P2M",S="MIBwSRJ5XZaCw1WWXXBn",F="dEuzpK3s_BmlRiVNFude",C="IeJGaG6QXRvfMka0gCSG",x="Wh0HGq_CXEX_JqbSYvx7",w="MVRnUhNC4ZMglLR56YMn",E="jjQUaCx5rvU20rWBzyLA",N="ES02HhKmADP_AdcKPs1e",k="IYwEYGRUJ5RTtr0EyBV1",O="YYlv5PB5fGQthi9XzTQg";var X=i(86070),R=u.memo((function(e){var t=e.isLoading,i=(0,m.h)("shimmer");return(0,X.jsx)("div",{ref:i,className:y()(b,(0,v.A)({},O,t))})})),P=u.memo((function(e){var t=e.cardImage,i=e.isLoading;return(0,X.jsx)(g.v,{className:A,media:t||(0,X.jsx)(R,{isLoading:i}),id:"feature-skeleton-card-id",title:(0,X.jsx)(h.Y,{as:"div",variant:"bodyMediumBold",className:N,charCount:10,isLoading:i}),body:(0,X.jsx)(h.Y,{as:"div",variant:"bodySmall",className:k,charCount:15,isLoading:i}),layout:"wide",size:"xl",variant:"elevated"})})),I=i(26017),L=i(95514),Q=i(16247),H=i.n(Q),B=(i(49932),i(96525),i(21746)),U=i(82916),_=i(46567);var D={offset:0,limit:50,flatten:!0,sort:{field:_.nw.RELEVANCE,order:_.xB.DESC}};function G(e){var t=(0,U.g)(),i=(0,u.useContext)(B.w),a=(0,u.useMemo)((function(){return function(e){return function(){var t=(0,L.A)(H().mark((function t(i){var a;return H().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==i){t.next=2;break}return t.abrupt("return",null);case 2:return t.prev=2,t.next=5,e.getPlaylist(i.uri);case 5:return a=t.sent,t.abrupt("return",null!=a&&a.metadata.hasSpotifyTracks?a:null);case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()}(i)}),[i]),n=(0,u.useState)([]),r=(0,I.A)(n,2),o=r[0],l=r[1],s=(0,u.useState)(!1),c=(0,I.A)(s,2),f=c[0],d=c[1],v=(0,u.useState)(null),p=(0,I.A)(v,2),y=p[0],g=p[1];return(0,u.useEffect)((function(){d(!0),t.getContents(D).then((function(t){return function(e,t){return e.items.filter(_.Af).filter((function(e){return e.isOwnedBySelf&&e.totalLength>0})).slice(0,t)}(t,e)})).then((function(e){return Promise.all(e.map(a))})).then((function(e){return e.filter((function(e){return null!==e}))})).then((function(e){return l(e)})).catch(g).finally((function(){return d(!1)}))}),[t,a,e]),{loading:f,playlists:o,error:y}}var M=i(69168),V=i(12971),z=i(65878),T=function(){var e=(0,V.t)(),t=(0,z.K)(e.quality.streamingQuality),i=(0,I.A)(t,2),a=i[0].data,n=i[1].mutate,r=(0,z.K)(e.quality.maxSupportedQuality),o=(0,I.A)(r,1)[0].data;if(void 0===a||void 0===o)return{isAvailable:!1,isEnabled:!1,enableVeryHighQualityAudio:function(){}};return{isAvailable:o>=M.Qi.VERY_HIGH,isEnabled:a===M.a1.VERY_HIGH,enableVeryHighQualityAudio:function(){n(M.a1.VERY_HIGH)}}},q=i(82035),Y=i(41485),W=i(48575),J=i(60034),Z=(i(63619),i(63222),i(41679),i(81443),i(74457),i(6844),i(77458),i(37892),i(50247),i(67626),i(88190),i(42715));function K(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function $(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?K(Object(i),!0).forEach((function(t){(0,v.A)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var ee=function(e){return e.desktopSessionsSinceFullActivation>=2||e.desktopSessions>=20};var te=i(61022),ie=i(54925),ae=i(34848),ne=i(96964),re=function(e){var t=e.children,i=e.isActivated,a=e.inShelf;return(0,X.jsx)(ie.E,{as:"p",variant:"bodyMediumBold",className:y()(F,(0,v.A)({},C,!a)),style:{paddingInlineEnd:i?"18px":"initial"},children:t})},oe=i(99580),le=i(29066),se=u.memo((function(e){var t=e.image,i=e.onClick,a=e.id,n=e.title,r=e.body,o=e.footer,l=e.activated,s=e.premiumOnlyFeature;return(0,X.jsx)(g.v,{className:A,media:t,id:a||"",title:n,body:r,layout:"wide",size:"xl",pretitle:(0,X.jsxs)(X.Fragment,{children:[s&&(0,X.jsx)(le.T,{color:"#ffffff",height:"18",className:S}),l&&(0,X.jsx)(oe.i,{size:"small",className:j})]}),variant:"elevated",footer:o,onClick:i})})),ce=i(12749);var ue=u.memo((function(e){var t=e.activated,i=e.position,a=e.inShelf,n=e.onFeatureActivate,r=(0,te.Zp)(),o="/blend/invitation",l=function(e,t,i,a){var n=(0,q.r)(f.i,{}),r=n.spec,o=n.logger,l=(0,q.r)(ce.d,{}),s=l.spec,c=l.logger;return e?{eventFactory:t?r.shelfContainerFactory().activatedBlendCardFactory({position:i,uri:a}):r.shelfContainerFactory().blendCardFactory({position:i,uri:a}),logger:o}:{eventFactory:t?s.activatedBlendCardFactory({position:i,uri:a}):s.blendCardFactory({position:i,uri:a}),logger:c}}(a,t,i,o),s=l.eventFactory,c=l.logger;(0,u.useEffect)((function(){c.logImpression(s.impression())}),[]);var v=function(){n(),c.logInteraction(s.hitUiNavigate({destination:o})),r(o)};return(0,X.jsx)(se,{activated:t,premiumOnlyFeature:!1,image:(0,ne.b)("images/feature-activation-shelf-blend.png"),onClick:v,title:(0,X.jsx)(re,{isActivated:t,inShelf:a,children:d.Ru.get("web-player.feature-activation-shelf.blend.title")}),body:(0,X.jsxs)("div",{className:x,children:[(0,X.jsx)(ie.E,{as:"p",variant:"bodySmall",className:w,children:d.Ru.get("web-player.feature-activation-shelf.blend.description")}),(0,X.jsx)("div",{className:E,children:(0,X.jsx)(ae.n,{size:"small",onClick:v,children:d.Ru.get("web-player.feature-activation-shelf.invite.cta")})})]})})})),fe=i(51519);var de=u.memo((function(e){var t,i,a=e.playlist,n=e.activated,o=e.position,l=e.inShelf,s=e.onFeatureActivate,c=(0,te.Zp)(),v=function(e,t,i,a){var n=(0,q.r)(f.i,{}),r=n.spec,o=n.logger,l=(0,q.r)(ce.d,{}),s=l.spec,c=l.logger;return e?{eventFactory:t?r.shelfContainerFactory().activatedCollaborativePlaylistCardFactory({position:i,uri:a}):r.shelfContainerFactory().collaborativePlaylistCardFactory({position:i,uri:a}),logger:o}:{eventFactory:t?s.activatedCollaborativePlaylistCardFactory({position:i,uri:a}):s.collaborativePlaylistCardFactory({position:i,uri:a}),logger:c}}(l,n,o,null!==(t=null==a||null===(i=a.metadata)||void 0===i?void 0:i.uri)&&void 0!==t?t:""),p=v.eventFactory,y=v.logger;(0,u.useEffect)((function(){a&&y.logImpression(p.impression())}),[a]);var g=function(){if(a){s();var e=(0,fe.o_)(a.metadata.uri).toURLPath(!0),t="".concat(e,"?feature-activation=").concat(r.X.CollaborativePlaylists);y.logInteraction(p.hitUiNavigate({destination:t})),c(t)}};return a?(0,X.jsx)(se,{premiumOnlyFeature:!1,activated:n,image:a.metadata.images[0].url,id:"collaborative-playlists-card",onClick:g,title:(0,X.jsx)(re,{isActivated:n,inShelf:l,children:d.Ru.get("web-player.feature-activation-shelf.collaborative-playlists.title",{playlist:a.metadata.name})}),body:(0,X.jsxs)("div",{className:x,children:[(0,X.jsx)(ie.E,{as:"p",variant:"bodySmall",className:w,children:d.Ru.get("web-player.feature-activation-shelf.collaborative-playlists.description")}),(0,X.jsx)("div",{className:E,children:(0,X.jsx)(ae.n,{onClick:g,size:"small",children:d.Ru.get("web-player.feature-activation-shelf.invite.cta")})})]})}):null})),ve=i(73504);var pe=u.memo((function(e){var t=e.activated,i=e.position,a=e.inShelf,n=e.onFeatureActivate,r=(0,J._E)(),o=r.context,l=r.metadata,s=o.triggerPlay,c=o.isPlaying,v=(0,J.FJ)().maybeAddDJToLibrary,p=(0,J._x)()&&l,y=function(e,t,i){var a=(0,q.r)(f.i,{}),n=a.spec,r=a.logger,o=(0,q.r)(ce.d,{}),l=o.spec,s=o.logger;return e?{eventFactory:t?n.shelfContainerFactory().activatedDjCardFactory({position:i}):n.shelfContainerFactory().djCardFactory({position:i}),logger:r}:{eventFactory:t?l.activatedDjCardFactory({position:i}):l.djCardFactory({position:i}),logger:s}}(a,t,i),g=y.eventFactory,h=y.logger;(0,u.useEffect)((function(){p&&h.logImpression(g.impression())}),[p]);var m=function(){n(),h.logInteraction(g.hitPlay({itemToBePlayed:ve.N6})),c||(v(),s())};return p?(0,X.jsx)(se,{activated:t,premiumOnlyFeature:!1,image:l.images[0].url,onClick:m,title:(0,X.jsx)(re,{isActivated:t,inShelf:a,children:d.Ru.get("web-player.feature-activation-shelf.ai-dj.title")}),body:(0,X.jsxs)("div",{className:x,children:[(0,X.jsx)(ie.E,{as:"p",variant:"bodySmall",className:w,children:d.Ru.get("web-player.feature-activation-shelf.ai-dj.description")}),(0,X.jsx)("div",{className:E,children:(0,X.jsx)(ae.n,{size:"small",onClick:m,disabled:c,children:d.Ru.get("web-player.feature-activation-shelf.ai-dj.cta")})})]})}):null})),ye=i(99604);var ge=u.memo((function(e){var t=e.inShelf,i=e.activated,a=e.position,n=e.destination,r=e.onFeatureActivate,o=function(e,t,i){var a=(0,q.r)(f.i,{}),n=a.spec,r=a.logger,o=(0,q.r)(ce.d,{}),l=o.spec,s=o.logger;return e?{eventFactory:t?n.shelfContainerFactory().activatedGroupSessionsCardFactory({position:i}):n.shelfContainerFactory().groupSessionsCardFactory({position:i}),logger:r}:{eventFactory:t?l.activatedGroupSessionsCardFactory({position:i}):l.groupSessionsCardFactory({position:i}),logger:s}}(t,i,a),l=o.eventFactory,s=o.logger;(0,u.useEffect)((function(){s.logImpression(l.impression())}),[]);var c=function(){r(),s.logInteraction(l.hitNavigateToExternalUri({destination:n})),window.open(n,"_blank","noopener")};return(0,X.jsx)(se,{activated:i,premiumOnlyFeature:!1,image:(0,ne.b)("images/feature-activation-shelf-group-sessions.png"),onClick:c,title:(0,X.jsx)(re,{isActivated:i,inShelf:t,children:d.Ru.get("web-player.feature-activation-shelf.group-sessions.title")}),body:(0,X.jsxs)("div",{className:x,children:[(0,X.jsx)(ie.E,{as:"p",variant:"bodySmall",className:w,children:d.Ru.get("web-player.feature-activation-shelf.group-sessions.description-general")}),(0,X.jsx)("div",{className:E,children:(0,X.jsx)(ae.n,{size:"small",onClick:c,iconTrailing:ye.p,children:d.Ru.get("web-player.feature-activation-shelf.group-sessions.cta")})})]})})}));var he=u.memo((function(e){var t=e.position,i=e.inShelf,a=e.onFeatureActivate,n=(0,te.Zp)(),o=T(),l=o.isAvailable,s=o.isEnabled,c=o.enableVeryHighQualityAudio,v=function(e,t,i){var a=(0,q.r)(f.i,{}),n=a.spec,r=a.logger,o=(0,q.r)(ce.d,{}),l=o.spec,s=o.logger;return e?{eventFactory:t?n.shelfContainerFactory().activatedAudioQualityCardFactory({position:i}):n.shelfContainerFactory().audioQualityCardFactory({position:i}),logger:r}:{eventFactory:t?l.activatedAudioQualityCardFactory({position:i}):l.audioQualityCardFactory({position:i}),logger:s}}(i,s,t),p=v.eventFactory,y=v.logger;(0,u.useEffect)((function(){l&&y.logImpression(p.impression())}),[]);var g=function(e){a();var t="".concat("/preferences").concat(e?"?".concat(e):"");y.logInteraction(p.hitUiNavigate({destination:t})),n(t)},h=function(){y.logInteraction(p.hitSetSettingField()),c(),g("feature-activation=".concat(r.X.VeryHighQualityAudio))};return l?(0,X.jsx)(se,{activated:s,premiumOnlyFeature:!1,image:(0,ne.b)("images/feature-activation-shelf-audio-quality.png"),id:"audio-quality-card",onClick:s?function(){return g()}:h,title:(0,X.jsx)(re,{isActivated:s,inShelf:i,children:d.Ru.get("web-player.feature-activation-shelf.audio-quality.title")}),body:(0,X.jsxs)("div",{className:x,children:[(0,X.jsx)(ie.E,{as:"p",variant:"bodySmall",className:w,children:d.Ru.get("web-player.feature-activation-shelf.audio-quality.description")}),(0,X.jsx)("div",{className:E,children:(0,X.jsx)(ae.n,{onClick:s?function(){return g()}:h,size:"small",iconLeading:s?oe.i:void 0,children:s?d.Ru.get("web-player.feature-activation-shelf.audio-quality.cta_alt"):d.Ru.get("web-player.feature-activation-shelf.audio-quality.cta")})})]})}):null}));var me="/concerts",be=u.memo((function(e){var t=e.activated,i=e.position,a=e.inShelf,n=e.onFeatureActivate,r=(0,te.Zp)(),o=function(e,t,i,a){var n=(0,q.r)(f.i,{}),r=n.spec,o=n.logger,l=(0,q.r)(ce.d,{}),s=l.spec,c=l.logger;return e?{eventFactory:t?r.shelfContainerFactory().activatedLiveEventsCardFactory({position:i,uri:a}):r.shelfContainerFactory().liveEventsCardFactory({position:i,uri:a}),logger:o}:{eventFactory:t?s.activatedLiveEventsCardFactory({position:i,uri:a}):s.liveEventsCardFactory({position:i,uri:a}),logger:c}}(a,t,i,me),l=o.eventFactory,s=o.logger;(0,u.useEffect)((function(){s.logImpression(l.impression())}),[]);var c=function(){n(),s.logInteraction(l.hitUiNavigate({destination:me})),r(me)};return(0,X.jsx)(se,{activated:t,premiumOnlyFeature:!1,image:(0,ne.b)("images/feature-activation-shelf-live-events.png"),id:"live-events-card",onClick:c,title:(0,X.jsx)(re,{isActivated:t,inShelf:a,children:d.Ru.get("web-player.feature-activation-shelf.live-events.title")}),body:(0,X.jsxs)("div",{className:x,children:[(0,X.jsx)(ie.E,{as:"p",variant:"bodySmall",className:w,children:d.Ru.get("web-player.feature-activation-shelf.live-events.description")}),(0,X.jsx)("div",{className:E,children:(0,X.jsx)(ae.n,{onClick:c,size:"small",children:d.Ru.get("web-player.feature-activation-shelf.live-events.cta")})})]})})})),je=i(26320);var Ae=u.memo((function(e){var t=e.activated,i=e.playlist,a=e.position,n=e.inShelf,o=e.onFeatureActivate,l=(0,je.i)().setSeen,s=(0,te.Zp)(),c=function(e,t,i){var a=(0,q.r)(f.i,{}),n=a.spec,r=a.logger,o=(0,q.r)(ce.d,{}),l=o.spec,s=o.logger;return e?{eventFactory:t?n.shelfContainerFactory().activatedSmartShuffleCardFactory({position:i}):n.shelfContainerFactory().smartShuffleCardFactory({position:i}),logger:r}:{eventFactory:t?l.activatedSmartShuffleCardFactory({position:i}):l.smartShuffleCardFactory({position:i}),logger:s}}(n,t,a),v=c.eventFactory,p=c.logger;(0,u.useEffect)((function(){i&&p.logImpression(v.impression())}),[i]);var y=(0,u.useCallback)((function(){if(i){o(),p.logInteraction(v.hitUiNavigate({destination:i.metadata.uri})),l(!1);var e=(0,fe.o_)(i.metadata.uri).toURLPath(!0);s("".concat(e,"?feature-activation=").concat(r.X.SmartShuffle))}}),[s,i,l,p,v,o]);return i?(0,X.jsx)(se,{activated:t,premiumOnlyFeature:!1,image:i.metadata.images[0].url,onClick:y,title:(0,X.jsx)(re,{isActivated:t,inShelf:n,children:d.Ru.get("web-player.feature-activation-shelf.smart-shuffle.title",{playlist:i.metadata.name})}),body:(0,X.jsxs)("div",{className:x,children:[(0,X.jsx)(ie.E,{as:"p",variant:"bodySmall",className:w,children:d.Ru.get("web-player.feature-activation-shelf.smart-shuffle.description")}),(0,X.jsx)("div",{className:E,children:(0,X.jsx)(ae.n,{size:"small",onClick:y,children:d.Ru.get("web-player.feature-activation-shelf.smart-shuffle.cta")})})]})}):null})),Se=i(24427),Fe=i(71041),Ce=i(36109),xe=i(22030);const we="RvSsw_CWBCtHhojt6bY_";var Ee=u.memo(u.forwardRef((function(e,t){var i=e.className,a=e.render,n=(0,u.useRef)(null),r=(0,u.useState)({columnCount:-1,columnWidth:-1,gridGap:24}),o=(0,I.A)(r,2),l=o[0],s=o[1];(0,u.useImperativeHandle)(t,(function(){return n.current}));var c=(0,u.useCallback)((function(){var e=n.current;if(e&&e.parentElement){var t=e.parentElement.offsetWidth,i=function(e){return e<700?1:e<1e3?2:3}(t),a=function(e){return 2===e?12:3===e?18:24}(i),r=Math.floor((t-(i-1)*a)/i);s({columnCount:i,columnWidth:r,gridGap:a})}}),[]);(0,xe.w)({refOrElement:n,observeOnly:"width",onResize:function(){c()}}),(0,u.useLayoutEffect)((function(){c()}),[c]);var f={"--column-count":"".concat(l.columnCount),"--grid-gap":"".concat(l.gridGap,"px")};return(0,X.jsx)("div",{ref:n,className:y()(we,i),style:f,children:a(l)})})));Ee.displayName="GridContainer";const Ne="QD8u8vCxcfIpJC14IBqg",ke="H4yLgZB7CQJlPH3u5Qbi",Oe="jNsZ_X7AAz13oxU5Sx0G",Xe="b49pU5FuAfdm6Ub0x7N3";function Re(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,a)}return i}function Pe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(i),!0).forEach((function(t){(0,v.A)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Re(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Ie=u.memo((function(e){var t=e.title,i=e.children,a=e.seeAllUri,n=e.className,r=void 0===n?"":n,o=e.testId,l=void 0===o?"component":o,s=e.seeAllLabel,c=e.onClickShelfTitle,f=e.onClickShelfSeeAll,d=e.showAll,p=e.elementRef,g=(0,u.useCallback)((function(e){var t=e.columnCount;return(0,X.jsx)(X.Fragment,{children:d?i:Array.isArray(i)&&i.filter((function(e,i){return i<t}))})}),[i,d]);return Array.isArray(i)&&0===i.length?null:(0,X.jsxs)("section",{ref:p,className:y()(r,Ne),"data-testid":"".concat(l,"-shelf"),"aria-label":t,children:[(0,X.jsx)("div",{className:ke,children:(0,X.jsx)(Fe.U,{title:t,seeAllUri:a,seeAllLabel:s,hasMoreElements:!d,onClickTitle:c,onClickSeeAll:f})}),(0,X.jsx)(Ee,{className:y()(Oe,(0,v.A)({},Xe,d)),render:g})]})}));Ie.displayName="BaseShelf";var Le=function(e){return(0,X.jsx)(Se.s,{onError:function(e){(0,Ce.Jy)(e,"Shelf")},children:(0,X.jsx)(Ie,Pe(Pe({},e),{},{showAll:e.showAll}))})};const Qe=u.memo((function(e){var t=e.features,i=e.localStorageKey,n=(0,q.r)(f.i,{}),o=n.spec,l=n.logger,s=T(),c=s.isAvailable,p=s.isEnabled,y=c&&p,g=(0,J._x)(),h=(0,J.NO)().metadata,m=(0,W.X)(),b=T().isAvailable,j=(0,u.useMemo)((function(){return function(e,t){var i=e.filter((function(e){return e.feature===r.X.VeryHighQualityAudio})),n=e.filter((function(e){return e.feature!==r.X.VeryHighQualityAudio}));return t?[].concat((0,a.A)(n.filter((function(e){return!e.activated}))),(0,a.A)(n.filter((function(e){return e.activated}))),(0,a.A)(i)):[].concat((0,a.A)(e.filter((function(e){return!e.activated}))),(0,a.A)(e.filter((function(e){return e.activated}))))}(t,y)}),[y,t]),A=G(2),S=A.playlists,F=A.loading,C=(0,u.useMemo)((function(){return j.filter((function(e){var t=e.feature;return!!(t!==r.X.Dj||g&&h)&&(!!(t!==r.X.SmartShuffle||m&&0!==S.length)&&(t!==r.X.VeryHighQualityAudio||b?t!==r.X.CollaborativePlaylists||0!==S.length:null))}))}),[j,m,b,g,h,S]),x=function(e,t){var i=t||"feature-activation-shelf-v3-interaction-state",a=(0,Z.x)(i,{featureInteractionMapping:(0,v.A)((0,v.A)((0,v.A)((0,v.A)((0,v.A)((0,v.A)((0,v.A)({},r.X.VeryHighQualityAudio,!1),r.X.Dj,!1),r.X.SmartShuffle,!1),r.X.Blend,!1),r.X.GroupSessions,!1),r.X.LiveEvents,!1),r.X.CollaborativePlaylists,!1),desktopSessions:0,desktopSessionsSinceFullActivation:0}),n=(0,I.A)(a,2),o=n[0],l=n[1];return(0,u.useEffect)((function(){if(!e){var t=Object.values(o.featureInteractionMapping).reduce((function(e,t){return e&&t}),!0);l($($({},o),{},{desktopSessionsSinceFullActivation:t?o.desktopSessionsSinceFullActivation+1:o.desktopSessionsSinceFullActivation,desktopSessions:o.desktopSessions+1}))}}),[]),{hideShelf:!e&&ee(o),interactionState:o,setFeatureActivation:function(e,t){l($($({},o),{},{featureInteractionMapping:$($({},o.featureInteractionMapping),{},(0,v.A)({},e,t))}))}}}(e.showAll,i),w=x.hideShelf,E=x.setFeatureActivation;(0,u.useEffect)((function(){0!==C.length&&(w?l.logImpression(o.hideShelfImpressionElementFactory().impression()):l.logImpression(o.shelfContainerFactory().impression()))}),[w]);var N=(0,u.useCallback)((function(){l.logInteraction(o.shelfTitleFactory({uri:e.uri}).hitUiNavigate({destination:e.uri}))}),[o,l,e.uri]),k=(0,u.useCallback)((function(){l.logInteraction(o.seeAllFeaturesFactory({uri:e.uri}).hitUiNavigate({destination:e.uri}))}),[o,l,e.uri]);return w||0===C.length?null:(0,X.jsx)(Le,{title:d.Ru.get("web-player.feature-activation-shelf.generic-title"),seeAllUri:e.uri,showAll:e.showAll,seeAllLabel:d.Ru.get("web-player.feature-activation-shelf.see_more"),onClickShelfTitle:N,onClickShelfSeeAll:k,children:F?(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(P,{isLoading:!0}),(0,X.jsx)(P,{isLoading:!0}),(0,X.jsx)(P,{isLoading:!0}),(0,X.jsx)(P,{isLoading:!0}),(0,X.jsx)(P,{isLoading:!0}),(0,X.jsx)(P,{isLoading:!0})]}):C.map((function(t,i){return function(e,t,i,a,n){var o,l,s;switch(e.feature){case r.X.GroupSessions:return(0,X.jsx)(ge,{activated:e.activated,position:t,inShelf:i,destination:e.destination||"",onFeatureActivate:function(){return a(r.X.GroupSessions,!0)}},"feature-activation-shelf-group-sessions");case r.X.CollaborativePlaylists:return(0,X.jsx)(de,{activated:e.activated,playlist:null!==(o=null!==(l=n[1])&&void 0!==l?l:n[0])&&void 0!==o?o:null,position:t,inShelf:i,onFeatureActivate:function(){return a(r.X.CollaborativePlaylists,!0)}},"feature-activation-shelf-collaborative-playlist");case r.X.Blend:return(0,X.jsx)(ue,{activated:e.activated,position:t,inShelf:i,onFeatureActivate:function(){return a(r.X.Blend,!0)}},"feature-activation-shelf-blend");case r.X.LiveEvents:return(0,X.jsx)(be,{activated:e.activated,position:t,inShelf:i,onFeatureActivate:function(){return a(r.X.LiveEvents,!0)}},"feature-activation-shelf-live-events");case r.X.VeryHighQualityAudio:return(0,X.jsx)(he,{position:t,inShelf:i,onFeatureActivate:function(){return a(r.X.VeryHighQualityAudio,!0)}},"feature-activation-shelf-very-high-quality-audio");case r.X.Dj:return(0,X.jsx)(pe,{activated:e.activated,position:t,inShelf:i,onFeatureActivate:function(){return a(r.X.Dj,!0)}},"feature-activation-shelf-dj");case r.X.SmartShuffle:return(0,X.jsx)(Ae,{activated:e.activated,playlist:null!==(s=n[0])&&void 0!==s?s:null,position:t,inShelf:i,onFeatureActivate:function(){return a(r.X.SmartShuffle,!0)}},"feature-activation-shelf-smart-shuffle");default:return(0,Y.k)(e.feature),null}}(t,i,!e.showAll,E,S)}))})}));var He=function(e){var t=e.uri,i=e.sectionItems,a=e.showAll,n=void 0!==a&&a,r=e.localStorageKey;return(0,X.jsx)(Qe,{features:c(i),showAll:n,uri:t,localStorageKey:r})}}}]);
//# sourceMappingURL=xpui-feature-activation.js.map