"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[8228],{37152:(e,t,n)=>{n.r(t),n.d(t,{FeatureActivationShelf:()=>Qe});var r=n(59496),a=n(92053),i=n(60647),o=n(96766),c=n(47018),s=n(22056),l=n(24255),u=(n(25750),n(26870),n(53987),n(79075),n(33208),n(93019),n(86978),n(98618),n(40905),n(79410),n(21105),n(72753),n(33892)),f=n(21818),d=n(41161),p=n(82020),h=n(84875),g=n.n(h),y=n(61527),m=n(71789);const b="uDOC2Oah0jn_p7N7l2Id",v="hwhquP1FOxRcCnf84P2M",j="bijDFKtWL1TJBF7X9Gp3",O="NTywvDEuW1PlcoR__9XV",S="t1SDLPBbSPbfihznNZdi",P="CvyMWBz1l8dSOsf4r_Ha",C="R32cBJPV9ccjWJYS1TLI",w="fzmowfLpLz7UlIyJThU8",x="MIBwSRJ5XZaCw1WWXXBn",E="dEuzpK3s_BmlRiVNFude",k="MVRnUhNC4ZMglLR56YMn",N="xiaMaZPt8ykPGR8gkQ53",D="mwBKJFOe7ee6V2MdmJyB",I="LziKPm9lTkWR0I7zD_rC";var L=n(4637),F=r.memo((function(e){var t=e.image;return(0,L.jsx)("div",{className:j,children:(0,L.jsx)("div",{className:O,children:(0,L.jsx)(m.E,{className:S,src:t,loading:"lazy"})})})})),A=n(74140),Z=n(54151);const _="mKkYwwDvRoTIEnqf9Mlt",B="ES02HhKmADP_AdcKPs1e",R="IYwEYGRUJ5RTtr0EyBV1",T="YYlv5PB5fGQthi9XzTQg";var U=r.memo((function(e){var t=e.isLoading,n=(0,Z.h)("shimmer");return(0,L.jsx)("div",{ref:n,className:g()(O,(0,l.Z)({},T,t))})})),Q=r.memo((function(e){var t=e.cardImage,n=e.isLoading;return(0,L.jsxs)("div",{className:g()(v,_),"aria-hidden":!0,children:[(0,L.jsx)("div",{className:j,children:t||(0,L.jsx)(U,{isLoading:n})}),(0,L.jsx)("div",{className:P,children:(0,L.jsxs)("div",{className:C,children:[(0,L.jsx)(A.C,{as:"div",variant:"balladBold",className:B,charCount:10,isLoading:n}),(0,L.jsx)(A.C,{as:"div",variant:"mesto",className:R,charCount:15,isLoading:n})]})})]})})),z=r.memo((function(e){var t=e.children,n=e.image,r=e.isLoading,a=e.onClick,i=e.id;return r?(0,L.jsx)(Q,{isLoading:!0}):(0,L.jsxs)("div",{className:g()(v),onClick:a,children:[(0,L.jsx)(F,{image:n}),(0,L.jsx)("div",{className:P,children:(0,L.jsx)("div",{className:C,children:(0,L.jsxs)("div",{className:w,children:[(0,L.jsx)(y.D,{color:"#ffffff",height:"18",className:x}),t]})})}),(0,L.jsx)("div",{"data-testid":i,onClick:a,className:b})]})}));function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M="https://newsroom.spotify.com/2021-09-09/get-perfect-song-recommendations-in-the-playlists-you-create-with-enhance/",G=r.memo((function(e){var t=e.isLoading,n=void 0!==t&&t,a=e.spec,i=e.logger,o=e.setInteractionState,c=e.interactionState,l=(0,p.e)().openURL;(0,r.useEffect)((function(){i.logImpression(a.shelfContainerFactory().enchanceCardFactory().impression())}),[a,i]);var h=(0,r.useCallback)((function(e){e.stopPropagation(),i.logInteraction(a.shelfContainerFactory().enchanceCardFactory().hitNavigateToExternalUri({destination:M})),o(W(W({},c),{},{clickedEnhanceCard:!0})),l(M)}),[l,a,i,o,c]);return(0,L.jsxs)(z,{image:(0,d.g)("images/feature-activation-shelf-enhance-placeholder.png"),isLoading:n,onClick:h,children:[(0,L.jsx)(u.D,{as:"p",variant:"balladBold",className:E,children:s.ag.get("web-player.feature-activation-shelf.enhance-placeholder.title")}),(0,L.jsx)(u.D,{as:"p",variant:"mesto",className:k,children:s.ag.get("web-player.feature-activation-shelf.enhance.description")}),(0,L.jsx)(f.P,{className:N,buttonSize:"sm",onClick:h,children:s.ag.get("web-player.feature-activation-shelf.enhance-placeholder.cta")})]})})),H=n(14942),J=n(88769),q=n(26533),K=n.n(q),Y=(n(7232),n(84196),n(60011),n(85051)),X=n(10277),$=n(50023),ee=n(56799);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e){var t;return null!==(t=e.items.filter(ee.no).find((function(e){return e.isOwnedBySelf&&e.totalLength>0})))&&void 0!==t?t:null}var ae={offset:0,limit:50,flatten:!0,sort:{field:ee.bD.RELEVANCE,order:ee.As.DESC}};function ie(){var e=(0,$.o)(),t=(0,Y._)(),n=(0,r.useContext)(X.ZF),a=(0,r.useMemo)((function(){return function(e){return function(){var t=(0,J.Z)(K().mark((function t(n){var r;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==n){t.next=2;break}return t.abrupt("return",null);case 2:return t.prev=2,t.next=5,e.getPlaylist(n.uri);case 5:return r=t.sent,t.abrupt("return",null!=r&&r.metadata.hasSpotifyTracks?r:null);case 9:return t.prev=9,t.t0=t.catch(2),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e){return t.apply(this,arguments)}}()}(n)}),[n]),i=(0,r.useMemo)((function(){return function(e){return function(){var t=(0,J.Z)(K().mark((function t(n){var r,a;return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==n){t.next=2;break}return t.abrupt("return",null);case 2:return t.prev=2,t.next=5,e.getContextState(n.metadata.uri);case 5:return r=t.sent,a=r.isEnhanced,t.abrupt("return",ne(ne({},n),{},{isEnhanced:a}));case 10:return t.prev=10,t.t0=t.catch(2),t.abrupt("return",null);case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()}(t)}),[t]),o=(0,r.useState)(null),c=(0,H.Z)(o,2),s=c[0],l=c[1],u=(0,r.useState)(!1),f=(0,H.Z)(u,2),d=f[0],p=f[1],h=(0,r.useState)(null),g=(0,H.Z)(h,2),y=g[0],m=g[1];(0,r.useEffect)((function(){p(!0),e.getContents(ae).then(re).then(a).then(i).then(l).catch(m).finally((function(){return p(!1)}))}),[e,a,i]);var b=(0,r.useCallback)((function(){return null===s?Promise.reject("No playlist found."):t.getContextState(s.metadata.uri).then((function(e){return t.setIsEnhanced(s.metadata.uri,!e.isEnhanced)}))}),[s,t]);return{loading:d,playlistWithEnhanceState:s,toggleEnhanceState:b,error:y}}var oe=n(85388),ce=n(13034),se=n(53027),le=n(93924);function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de=r.memo((function(e){var t=e.isLoading,n=void 0!==t&&t,a=e.playlist,i=e.toggleEnhanceState,o=e.navigateToPlaylist,c=e.spec,d=e.logger,p=e.setInteractionState,h=e.interactionState,y=(0,le.U)(a.metadata.uri).isEnhanced;(0,r.useEffect)((function(){d.logImpression(c.shelfContainerFactory().enchanceCardFactory().impression())}),[c,d]);var m=(0,r.useCallback)((function(){d.logInteraction(c.shelfContainerFactory().enchanceCardFactory().hitEnhancePlaylist({playlist:a.metadata.uri})),o(a.metadata.uri),y||i(),p(fe(fe({},h),{},{clickedEnhanceCard:!0}))}),[i,y,a.metadata.uri,o,d,c,h,p]);return(0,L.jsxs)(z,{image:a.metadata.images[0].url,isLoading:n,onClick:m,children:[(0,L.jsx)(u.D,{as:"p",variant:"balladBold",className:E,children:s.ag.get("web-player.feature-activation-shelf.enhance.title",{playlist:a.metadata.name})}),(0,L.jsx)(u.D,{as:"p",variant:"mesto",className:k,children:s.ag.get("web-player.feature-activation-shelf.enhance.description")}),(0,L.jsx)(f.P,{className:g()(N,(0,l.Z)({},D,y)),buttonSize:"sm",iconLeading:se.e,onClick:m,children:y?s.ag.get("web-player.feature-activation-shelf.enhance.cta-enhanced"):s.ag.get("web-player.feature-activation-shelf.enhance.cta")})]})})),pe=n(65631);function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ye=r.memo((function(e){var t=e.isLoading,n=void 0!==t&&t,a=e.spec,i=e.logger,o=e.setInteractionState,c=e.interactionState,l=(0,r.useContext)(pe.O).setVisible;(0,r.useEffect)((function(){i.logImpression(a.shelfContainerFactory().groupSessionsCardFactory().impression())}),[a,i]);var p=function(){i.logInteraction(a.shelfContainerFactory().groupSessionsCardFactory().hitUiReveal()),o(ge(ge({},c),{},{clickedGroupSessionsCard:!0})),l(!0)};return(0,L.jsxs)(z,{image:(0,d.g)("images/feature-activation-shelf-group-sessions.png"),isLoading:n,onClick:p,children:[(0,L.jsx)(u.D,{as:"p",variant:"balladBold",className:E,children:s.ag.get("web-player.feature-activation-shelf.group-sessions.title")}),(0,L.jsx)(u.D,{as:"p",variant:"mesto",className:k,children:s.ag.get("web-player.feature-activation-shelf.group-sessions.description")}),(0,L.jsx)(f.P,{className:N,buttonSize:"sm",onClick:p,children:s.ag.get("web-player.feature-activation-shelf.group-sessions.cta")})]})})),me=n(67857),be=(n(15970),n(56110),n(73630),n(95410),n(57782),n(80443)),ve=n(39250);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=r.memo((function(e){var t,n,i,o,c=e.isLoading,p=void 0!==c&&c,h=e.spec,y=e.logger,m=e.interactionState,b=e.setInteractionState,v=(0,a.s0)(),j=(t=(0,ve.r)(),n=t.settings.values,i=t.setValue,{isAvailable:!!(o=n["audio.play_bitrate_enumeration"])&&(0,be.kN)(o.toString(),n)&&(0,be.gj)(n),isEnabled:o===be.PF.veryhigh.enum.toString(),enableVeryHighQualityAudio:function(){i("audio.play_bitrate_non_metered_enumeration",be.PF.veryhigh.enum),i("audio.play_bitrate_enumeration",be.PF.veryhigh.enum)}}),O=j.isAvailable,S=j.isEnabled,P=j.enableVeryHighQualityAudio;(0,r.useEffect)((function(){O&&y.logImpression(h.shelfContainerFactory().audioQualityCardFactory().impression())}),[h,y,O]),(0,r.useEffect)((function(){S&&b(Oe(Oe({},m),{},{hasVeryHighQualityAudio:!0}))}),[S,m,b]);var C=function(e){var t="".concat("/preferences").concat(e?"?".concat(e):"");y.logInteraction(h.shelfContainerFactory().audioQualityCardFactory().hitUiNavigate({destination:t})),v(t),b(Oe(Oe({},m),{},{clickedAudioQualityCard:!0}))},w=function(){y.logInteraction(h.shelfContainerFactory().audioQualityCardFactory().hitSetSettingField()),P(),C("feature-activation")};return O?(0,L.jsxs)(z,{image:(0,d.g)("images/feature-activation-shelf-audio-quality.png"),isLoading:p,id:"audio-quality-card",onClick:S?function(){return C()}:w,children:[(0,L.jsx)(u.D,{as:"p",variant:"balladBold",className:E,children:s.ag.get("web-player.feature-activation-shelf.audio-quality.title")}),(0,L.jsx)(u.D,{as:"p",variant:"mesto",className:k,children:s.ag.get("web-player.feature-activation-shelf.audio-quality.description")}),(0,L.jsx)(f.P,{className:g()(N,(0,l.Z)({},I,S)),onClick:S?function(){return C()}:w,buttonSize:"sm",iconLeading:S?me.N:void 0,children:S?s.ag.get("web-player.feature-activation-shelf.audio-quality.cta_alt"):s.ag.get("web-player.feature-activation-shelf.audio-quality.cta")})]}):null})),Pe=(n(84437),n(24896)),Ce=n(67008),we=n(76253),xe=n(1929);const Ee="RvSsw_CWBCtHhojt6bY_";var ke=r.memo(r.forwardRef((function(e,t){var n=e.className,a=e.render,i=(0,r.useRef)(null),o=(0,r.useState)({columnCount:-1,columnWidth:-1,gridGap:24}),c=(0,H.Z)(o,2),s=c[0],l=c[1];(0,r.useImperativeHandle)(t,(function(){return i.current}));var u=(0,r.useCallback)((function(){var e=i.current;if(e&&e.parentElement){var t=e.parentElement.offsetWidth,n=function(e){return e<700?1:e<1e3?2:3}(t),r=function(e){return 2===e?12:3===e?18:24}(n),a=Math.floor((t-(n-1)*r)/n);l({columnCount:n,columnWidth:a,gridGap:r})}}),[]);(0,xe.y)({refOrElement:i,observeOnly:"width",onResize:function(){u()}}),(0,r.useLayoutEffect)((function(){u()}),[u]);var f={"--column-width":"".concat(s.columnWidth,"px"),"--column-count":"".concat(s.columnCount),"--grid-gap":"".concat(s.gridGap,"px")};return(0,L.jsx)("div",{ref:i,className:g()(Ee,n),style:f,children:a(s)})})));ke.displayName="GridContainer";const Ne="QD8u8vCxcfIpJC14IBqg",De="H4yLgZB7CQJlPH3u5Qbi",Ie="jNsZ_X7AAz13oxU5Sx0G";function Le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ae=r.memo((function(e){var t=e.title,n=e.children,a=e.seeAllUri,i=e.className,o=void 0===i?"":i,c=e.testId,s=void 0===c?"component":c,l=e.seeAllLabel,u=e.onClickShelfTitle,f=e.onClickShelfSeeAll,d=e.elementRef,p=(0,r.useCallback)((function(e){var t=e.columnCount;return(0,L.jsx)(L.Fragment,{children:Array.isArray(n)&&n.filter((function(e,n){return n<t}))})}),[n]);return Array.isArray(n)&&0===n.length?null:(0,L.jsxs)("section",{ref:d,className:g()(o,Ne),"data-testid":"".concat(s,"-shelf"),"aria-label":t,children:[(0,L.jsx)("div",{className:De,children:(0,L.jsx)(Ce.r,{title:t,seeAllUri:a,seeAllLabel:l,hasMoreElements:!0,onClickTitle:u,onClickSeeAll:f})}),(0,L.jsx)(ke,{className:g()(Ie),render:p})]})}));Ae.displayName="BaseShelf";var Ze=function(e){return(0,L.jsx)(Pe.L,{onError:function(e){(0,we.vK)(e,"Shelf")},children:(0,L.jsx)(Ae,Fe({},e))})},_e=n(52336);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Te=function(e){return e.desktopSessionsSinceInteraction>=2||e.desktopSessions>=15};var Ue="https://support.spotify.com/us/article/premium-plans/",Qe=r.memo((function(){var e=ie(),t=e.loading,n=e.error,l=e.toggleEnhanceState,u=e.playlistWithEnhanceState,f=(0,a.s0)(),d=(0,ce.fU)(o.createDesktopFeatureActivationShelfEventFactory,{}),p=d.spec,h=d.logger,g=function(e){var t=(0,_e.z)("feature-activation-shelf-v2",{clickedGroupSessionsCard:!1,clickedEnhanceCard:!1,hasEnhancedPlaylist:!1,clickedAudioQualityCard:!1,hasVeryHighQualityAudio:!1,desktopSessions:0,desktopSessionsSinceInteraction:0}),n=(0,H.Z)(t,2),a=n[0],i=n[1];return(0,r.useEffect)((function(){var e=a.clickedEnhanceCard||a.hasEnhancedPlaylist,t=a.clickedAudioQualityCard||a.hasVeryHighQualityAudio;a.clickedGroupSessionsCard&&e&&t&&i(Re(Re({},a),{},{desktopSessionsSinceInteraction:a.desktopSessionsSinceInteraction+1})),i(Re(Re({},a),{},{desktopSessions:a.desktopSessions+1}))}),[]),(0,r.useEffect)((function(){null!==e&&e.isEnhanced&&i(Re(Re({},a),{},{hasEnhancedPlaylist:!0}))}),[e,a,i]),{hideShelf:Te(a),interactionState:a,setInteractionState:i}}(u),y=g.interactionState,m=g.setInteractionState,b=g.hideShelf;(0,r.useEffect)((function(){b?h.logImpression(p.hideShelfImpressionElementFactory().impression()):h.logImpression(p.shelfContainerFactory().impression())}),[p,h,b]);var v=(0,r.useCallback)((function(e){var t=(0,c.EC)(e).toURLPath(!0);f(t)}),[f]),j=null!==u&&!n,O=(0,r.useCallback)((function(){h.logInteraction(p.shelfTitleFactory().hitNavigateToExternalUri({destination:Ue}))}),[p,h]),S=(0,r.useCallback)((function(){h.logInteraction(p.seeAllFeaturesFactory().hitNavigateToExternalUri({destination:Ue}))}),[p,h]),P=(0,i.W6)(oe.Up,{loadingValue:!1});return b?null:(0,L.jsxs)(Ze,{seeAllUri:Ue,title:s.ag.get("web-player.feature-activation-shelf.title"),seeAllLabel:s.ag.get("web-player.feature-activation-shelf.see_more"),onClickShelfTitle:O,onClickShelfSeeAll:S,children:[P&&(j?(0,L.jsx)(de,{playlist:u,isLoading:t,toggleEnhanceState:l,navigateToPlaylist:v,spec:p,logger:h,setInteractionState:m,interactionState:y}):(0,L.jsx)(G,{isLoading:t,spec:p,logger:h,setInteractionState:m,interactionState:y})),(0,L.jsx)(ye,{isLoading:t,spec:p,logger:h,setInteractionState:m,interactionState:y}),(0,L.jsx)(Se,{isLoading:t,spec:p,logger:h,setInteractionState:m,interactionState:y})]})}))}}]);
//# sourceMappingURL=xpui-feature-activation-shelf.js.map