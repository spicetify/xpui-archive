"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[2342],{87627:(e,i,a)=>{a.r(i),a.d(i,{default:()=>De});var n=a(59496),t=a(61740),l=a(89605),s=a(56162),r=a(16004),o=a(77675),c=a(80546),d=a(3802),u=a(75112),m=a(300),g=a(72686),h=a(66476),k=a(57559),p=a(88513),x=a(91703),j=a(69383),v=a(16743),y=a(73997),b=a(33209),f=a(44743),N=a(29335),S=a(36472),C=a(55454),F=a(4055),I=a(4637);const D=({children:e,content:i,onIntercept:a=(()=>{})})=>{const t=(0,F.g)();let l;try{l=n.Children.only(e)}catch(i){return(0,I.jsx)(I.Fragment,{children:e})}return t?(0,I.jsx)(C.Nt,{trigger:"click",action:"open",placement:"bottom",offset:[0,20],content:i,children:n.cloneElement(l,{onClick:a})}):(0,I.jsx)(I.Fragment,{children:e})};var w=a(30366),U=a(79475),T=a(96848),A=a(98340),L=a(95634),P=a(95663);const M="WHINADihyTCx2VFxwY8X",V=({title:e,description:i})=>{const a=(0,t.I0)(),l=(0,T.qT)(),r=(0,P.o)();return(0,n.useEffect)((()=>{r({intent:"open-upsell",type:"view"})}),[r]),(0,I.jsx)(C.yv,{children:(0,I.jsxs)("div",{className:M,children:[(0,I.jsx)(s.D,{as:"p",variant:"cello",children:e}),(0,I.jsx)(s.D,{as:"p",variant:"mesto",children:i}),(0,I.jsxs)("div",{children:[(0,I.jsx)(w.o,{onClick:()=>{r({intent:"close-upsell",type:"click"}),l({type:"close"})},children:d.ag.get("action-trigger.button.not-now")}),(0,I.jsx)(U.D,{onClick:()=>{r({intent:"login",type:"click"}),a((0,L.sX)())},children:d.ag.get("login")})]})]})})},B=e=>(0,I.jsx)(A.ZP,{value:"tooltip-with-cta",children:(0,I.jsx)(V,{...e})}),E=({uri:e,...i})=>{const a=(0,N.j)();return(0,I.jsx)(D,{content:(0,I.jsx)(B,{title:d.ag.get("action-trigger.save-library"),description:d.ag.get("action-trigger.save-album")}),onIntercept:()=>a.storeAction(f.wH,{operation:S.pT.ADD,uris:[e]}),children:(0,I.jsx)(m.H,{...i})})};var z=a(77312),R=a(72071);const O={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"queryAlbumMerch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"albumUnion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"merch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumMerchItem"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumMerchItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Merch"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]};var q=a(88541);const $="iEG0moJ3mt1_j9Lho7MA",_=({albumName:e,albumURI:i})=>{const{data:a}=(n={uri:i},t={cacheTime:5*R.y},(0,R.a)(O,n,t));var n,t;const l=a?.albumUnion&&"merch"in a.albumUnion?a?.albumUnion?.merch?.items:[];return l&&l?.length>0?(0,I.jsx)("div",{className:"contentSpacing",children:(0,I.jsx)("div",{className:$,children:(0,I.jsx)(q.s,{id:e,uri:i,merchItems:l,merchVariant:"Album page merch items"})})}):null};var Q=a(40066),H=a(32812),Y=a(16201),X=a(80964),Z=a(59200),G=a(69812),K=a(40018),J=a(67565),W=a(66632),ee=a(48607),ie=a(6444),ae=a(96170),ne=a(75252),te=a(39206);const le=864e5,se=365.25*le,re=3.5;var oe=a(69527),ce=a(59180),de=a(82108),ue=a(50346),me=a(1996),ge=a(99308);const he=({releases:e})=>(0,I.jsx)(me.v,{children:e.map((e=>(0,I.jsx)(ge.s,{role:"menuitem",to:(0,ue.EC)(e.uri).toURLPath(!0),children:e.name},e.uri)))});var ke=a(80370),pe=a(82249),xe=a(44810);const je="n8Bz0c0v17whD3KfMdOk",ve="zddjxV2lX9ukNM5QXloA",ye="lVqlPjQLuQhK2flsxB78",be="O_EguRjsZ4uI1hHamkOA",fe="jcaQQxoVnuuhtVwDJU1R",Ne="fLS8v3_EfBadEerbGVoR",Se="in4OjUTflcsoj9RUpf05",Ce=n.lazy((()=>a.e(3558).then(a.bind(a,23558))));function Fe(e){switch(e){case pe.V.Single:return d.ag.get("single");case pe.V.Ep:return d.ag.get("ep");case pe.V.Compilation:return d.ag.get("compilation");case pe.V.Album:default:return d.ag.get("album")}}const Ie=({uri:e,album:i})=>{const a=(0,l.TH)(),b=(0,P.o)(),f=(0,H.k)(),N=(0,W.y)(),{spec:S,logger:C,UBIFragment:F}=(0,ae.fU)(c.createDesktopAlbumEventFactory,{data:{uri:e}}),D=(0,n.useMemo)((()=>S.trackListFactory()),[S]),w=(0,n.useMemo)((()=>S.moreByArtistShelfFactory()),[S]),U=n.useMemo((()=>S.actionBarFactory()),[S]),T=i.moreAlbumsByArtist,[A,L]=(0,W.Z)(e),M=parseInt(new URLSearchParams((0,l.TH)().search).get("index")||"0",10),V=(0,Q.Y)(e),{usePlayContextItem:B,togglePlay:R,isPlaying:O,isActive:q}=(0,ee.n)({uri:V},{featureIdentifier:"album"}),$=(0,n.useCallback)((()=>{const i=(0,X.aK)({isPlaying:O,isActive:q,spec:U.playButtonFactory(),logger:C,uri:e});R({loggingParams:i})}),[O,q,R,U,C,e]),J=(0,n.useCallback)((async()=>{let i;const a=U.saveButtonFactory();i=A?a.hitDislike({itemToBeDisliked:e}):a.hitLike({itemToBeLiked:e}),C.logInteraction(i),b({targetUri:e,intent:A?"unsave":"save",type:"click"});try{await L(!A)}catch{}}),[b,e,A,L,U,C]),ue=(0,n.useCallback)(((e,i)=>{if(S){const e=S.headerFactory().artistNameFactory().hitUiNavigate({destination:i.creator.uri});C.logInteraction(e)}}),[C,S]),me=(0,n.useCallback)((()=>new URLSearchParams(a.search.slice(1)).get("highlight")||""),[a.search]),ge=i.uri,ke=i.name,pe=i.albumType,Ie=i.release?.date,De=i.nrTracks,we=i.images,Ue=i.extractedColors?.colorRaw.hex,Te=i.artists,Ae=i.isPlayable,Le=i.isCatalogueRestricted,Pe=i.copyright.items,Me=i.courtesyLine,Ve=i.duration.durationMs,Be=i.duration.isEstimate,Ee=me(),ze=(0,t.v9)(de.Gg),Re=ze.overrides?.locale??d.ag.getLocale(),Oe=(0,ce.k)({uri:e,type:"locale"}),qe=(0,ie.OT)({albumName:ke,albumType:pe,albumArtists:Te.map((e=>e.name)).join(d.ag.getSeparator()),shouldLocalize:Oe,i18n:d.ag});(0,Y.Y5)(Ue||null);const $e=function(e){return(0,n.useMemo)((()=>{if(!e?.date)return null;if("day"===e.precision){const i=new Date(e.date),a=(new Date).getTime()-i.getTime(),n=a%se;return n<le*re||n>se-le*re?Math.round(a/se):null}return null}),[e])}(i.release);return(0,I.jsxs)("section",{className:je,"data-testid":"album-page",children:[(0,I.jsx)(x.$,{children:qe}),null!==$e?(0,I.jsx)(n.Suspense,{fallback:null,children:(0,I.jsx)(Ce,{colorLight:i?.extractedColors?.colorLight.hex,colorDark:i?.extractedColors?.colorDark.hex,name:ke,years:$e})}):null,(0,I.jsxs)(j.gF,{backgroundColor:Ue,children:[(0,I.jsxs)(v.W,{children:[(0,I.jsx)(z.$,{size:"md",onClick:()=>R(),disabled:!Ae,isPlaying:O,uri:e}),(0,I.jsx)(y.i,{text:ke,dragUri:e,dragLabel:ke})]}),(0,I.jsx)(Z._P,{menu:(0,I.jsx)(p.Y,{uri:i.uri,artistUri:Te?.[0]?.uri,sharingInfo:i.sharingInfo}),children:(0,I.jsx)(j.Oz,{dragUri:ge,images:we,name:ke,placeholderType:"album"})}),(0,I.jsxs)(j.sP,{children:[(0,I.jsx)(s.D,{variant:"mestoBold",children:Fe(pe)}),(0,I.jsx)(Z._P,{menu:(0,I.jsx)(p.Y,{uri:i.uri,artistUri:Te?.[0]?.uri,sharingInfo:i.sharingInfo}),children:(0,I.jsx)(j.xd,{dragUri:i.uri,dragLabel:i.name,children:ke})}),(0,I.jsx)(j.QS,{creators:Te,onCreatorClick:ue,releaseDate:Ie,totalTracks:De,durationMilliseconds:Ve,isEstimatedDuration:Be})]})]}),(0,I.jsx)(u.o,{backgroundColor:Ue,children:(0,I.jsxs)(u.F,{children:[(0,I.jsx)(z.$,{onClick:$,disabled:!Ae,isPlaying:O,size:"lg",uri:e}),(0,I.jsx)(E,{isAdded:!!A,onClick:J,disabled:!f&&!N?.getCapabilities().canModifyOffline,size:m.q.md,uri:e}),(0,I.jsx)(g.o,{uri:e,isFollowing:!!A,onClick:(i,a)=>(0,X.l7)(a,U.downloadButtonFactory(),C,e),onFollow:J,size:g.q.md}),(0,I.jsx)(G.y,{onShow:()=>(0,X.qq)(U,C),menu:(0,I.jsx)(p.Y,{uri:i.uri,artistUri:Te?.[0]?.uri,sharingInfo:i.sharingInfo}),children:(0,I.jsx)(h.z,{label:d.ag.get("more.label.context",ke)})})]})}),Le?(0,I.jsxs)("div",{className:ve,children:[(0,I.jsx)(s.D,{as:"h2",variant:"cello",className:ye,children:d.ag.get("windowed.product-album-header")}),(0,I.jsx)("div",{className:be,children:d.ag.get("windowed.product-album-description")})]}):null,(0,I.jsxs)("div",{className:"contentSpacing",children:[(0,I.jsx)(F,{spec:D,children:(0,I.jsx)(te.L,{ariaLabel:ke,nrTracks:(0,xe.y)(i.discs)?i.discs.totalCount+De:De,discs:i.discs,albumUri:ge,highlightUri:Ee,scrollToIndex:M,usePlayContextItem:B,initalTracks:i.items})}),(0,I.jsxs)("div",{className:Se,children:[(0,I.jsxs)("div",{children:[Ie&&(0,I.jsx)(s.D,{as:"p",variant:"mesto",children:(0,ne.BI)((0,ne.RX)(Ie),Re,{year:"numeric",month:"long",day:"numeric"})}),(0,I.jsx)(K.k,{copyrights:Pe,courtesyLine:Me})]}),i.releases.items.length>0&&(0,I.jsx)(Z.xV,{menu:(0,I.jsx)(he,{releases:i.releases.items}),children:(e,a,n)=>(0,I.jsxs)("button",{ref:n,className:Ne,type:"button",onClick:a,children:[(0,I.jsx)(s.D,{variant:"mesto",children:d.ag.get("album-page.more-releases",i.releases.items.length)}),e?(0,I.jsx)(r.U,{iconSize:16}):(0,I.jsx)(o.i,{iconSize:16})]})})]})]}),(0,I.jsx)(_,{albumName:ke,albumURI:ge}),(0,I.jsx)(I.Fragment,{children:T?.length>0&&(0,I.jsx)("div",{className:"contentSpacing",children:(0,I.jsx)(F,{spec:w,children:(0,I.jsx)(oe.q,{index:0,id:"more-albums",className:fe,title:d.ag.get("album-page.more-by-artist",Te?.[0]?.name),total:T.length,seeAllUri:`${Te?.[0]?.uri.replace("artist","app:artist")}:discography`,seeAllLabel:d.ag.get("artist-page.show-discography"),alwaysShowSeeAll:!0,children:T.map(((e,i)=>(0,I.jsx)(k.i,{index:i,artists:Te,images:e.images||[],name:e.name,uri:e.uri,year:e.year,type:e.albumType,sharingInfo:e.sharingInfo},e.uri)))})})})})]})},De=n.memo((function(){const{albumId:e}=(0,l.UO)(),i=`spotify:album:${e}`,{loading:a,error:n,data:t,canLoadOffline:s}=(0,ke.j)(i);return a||!t?(0,I.jsx)(b.h,{hasError:null!==n,loadOffline:s,errorMessage:d.ag.get("error.not_found.title.album")}):(0,I.jsx)(J.fd,{surface:J.Tg.ALBUM,uris:[i],children:(0,I.jsx)(Ie,{uri:i,album:t})})}))},40018:(e,i,a)=>{a.d(i,{k:()=>s});var n=a(56162);const t="rTMkDBDp47Eo12ZEQv4U";var l=a(4637);const s=({copyrights:e,courtesyLine:i})=>{const a=(e||[]).map(((e,i)=>{const a=e.text.replace(/^(\(C\)\s+)/,"").replace(/^(\(P\)\s+)/,"").replace(/^(©\s+)/,"").replace(/^(℗\s+)/,"");let t;return t="C"===e.type?"©":"P"===e.type?"℗":`(${e.type})`,(0,l.jsx)(n.D,{as:"p",variant:"finale",dir:"auto",children:`${t} ${a}`},i)}));return i&&a.unshift((0,l.jsx)(n.D,{as:"p",variant:"finale",dir:"auto",children:i},a.length)),(0,l.jsx)("div",{className:t,children:a})}}}]);
//# sourceMappingURL=xpui-routes-album.js.map